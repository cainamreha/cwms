var conciseCMS=conciseCMS||{regSess:false};var ccPoolFunctions=new Array();var ccInitFunctions=new Array();var ccPluginFunctions=new Array();var ccLoadingImg=new Image();var ccWaitImg=new Image();var ccInitCount=0;var ccInitSuccess=false;var ccEditorsSetup=false;var ccReloadEditors=false;var ccIsHandlingError=false;conciseCMS.ccHandleError=function(errmes,file,line){if(typeof(jAlert)=="function"&&errmes.indexOf("History")!==0&&errmes.indexOf("sortable")<0){jAlert(conciseCMS.ln.dberror,conciseCMS.ln.alerttitle);}console.log(errmes+" (script: "+file+", line: "+line+")");};window.onerror=function(errmes,file,line){if(!ccIsHandlingError){ccIsHandlingError=true;conciseCMS.ccHandleError(errmes,file,line);}};(function(cc){cc.arrayUnique=function(array){return $.grep(array,function(el,index){return index===$.inArray(el,array);});};cc.idCounter=0;cc.uniqueId=function(prefix){var id=++cc.idCounter+'';return prefix?prefix+id:id;};cc.getResourceUrl=function(url){var root=url.indexOf(cc.httpRoot.toString())===0?"":cc.httpRoot+'/';return root+url;};cc.isPhone=function(){var vw=parseInt($(window).width());return vw<=768;};cc.setLoadingImages=function(fe){if(fe){ccLoadingImg.src=cc.httpRoot+"/themes/"+cc.activeTheme+"/img/page-spinner.svg";}else{ccLoadingImg.src=cc.httpRoot+"/system/themes/"+cc.adminTheme+"/img/page-spinner.svg";}ccWaitImg.src=cc.httpRoot+"/system/themes/"+cc.adminTheme+"/img/page-spinner.svg";};})(conciseCMS);(function($){cc.container=$('div#container');cc.containerHeight=cc.container.height();cc.windowScrollTop=$(window).scrollTop();if(cc.container.attr('data-scroll')){cc.windowScrollTop=cc.container.attr('data-scroll');cc.container.fadeTo(0,0,function(){$(window).scrollTop(cc.windowScrollTop);cc.container.fadeTo(0,0).delay(300).fadeTo(300,1);});}$(window).scroll(function(){cc.windowScrollTop=$(window).scrollTop();});$.getWaitBar=function(callback){$.getDimDiv();var loadingDiv='<div class="loadingDiv loadingDiv-text tempHint"><p>'+ln.loading+'</p></div>';var loadingDivImg='<div class="loadingDiv loadingDiv-image tempHint"><img src="'+ccLoadingImg.src+'" alt="loading" class="loading" /></div>';var loadingStatus=$('body').append(loadingDiv,loadingDivImg);if(loadingStatus&&typeof(callback)=="function"){return callback();}return loadingStatus;},$.removeWaitBar=function(rmDD){$('.loadingDiv').remove();if(rmDD!==false){$.removeDimDiv();}return true;},$.getDimDiv=function(){if(!$('.dimDiv').length){var bodyHeight=parseInt($(document).height());cc.container.append('<div class="dimDiv" style="min-height:'+bodyHeight+'px;"></div>');return true;}return false;},$.removeDimDiv=function(){$('.dimDiv').remove();return true;},$.removeListBox=function(){var listBoxDom=cc.container.children('div.listBoxWrapper');if(listBoxDom.length){$(listBoxDom).remove();}return true;};$('body:not(.admin)').off("click",'#cc-fePanel .feMode');$('body:not(.admin)').on("click",'#cc-fePanel .feMode',function(e){e.preventDefault();var newDoc,container,scrollPos=cc.windowScrollTop,targetUrl=window.location.origin+window.location.pathname+$(this).attr('href');$.getWaitBar();$('div#container').fadeOut(300);$.get(targetUrl,function(data){newDoc=document.open("text/html","replace");newDoc.charset="UTF-8";newDoc.write(data.replace('<div id="container">','<div id="container" style="opacity:0;" data-scroll="'+scrollPos+'">'));newDoc.close();}).fail(function(){$.refreshPage();}).done(function(data){});return false;});})(jQuery);(function($){$.runAjaxSetup=function(){$.ajaxSetup({cache:false,statusCode:{403:function(){$.regenerateSession();return false;},404:function(){$.regenerateSession();return false;},406:function(){jAlert(ln.dberror,ln.alerttitle);setTimeout(function(){document.location.href=cc.httpRoot+"/admin";},3000);return false;}},error:function(jqXHR,exception){if(jqXHR.status===0){console.log('Not connect.\n Verify Network.');}else if(jqXHR.status==404){console.log('Requested page not found. [404]');}else if(jqXHR.status==500){console.log('Internal Server Error [500].');}else if(exception==='parsererror'){console.log('Requested JSON parse failed.');}else if(exception==='timeout'){console.log('Time out error.');}else if(exception==='abort'){console.log('Ajax request aborted.');}else{console.log('Uncaught Error.\n'+jqXHR.responseText);}}});},$.getJSONResponse=function(ajax){var resArr=ajax;if(typeof(resArr.alert)!="undefined"){jAlert(resArr.alert,ln.alerttitle);}else{jAlert(ln.dberror,ln.alerttitle);}return false;};})(jQuery);(function($){$.addInitFunction=function(fnObj,plugin){if(plugin===true){if(!$.arrayAssocFind(ccPluginFunctions,fnObj.name)){ccPluginFunctions.push(fnObj);}}else{if(!$.arrayAssocFind(ccInitFunctions,fnObj.name)){ccInitFunctions.push(fnObj);}}};})(jQuery);(function($){$.addInitFunctions=function(pool){$.each(pool,function(index,plugin){if(plugin.name){$.addInitFunction({name:plugin.name,params:plugin.params});}});};})(jQuery);(function($){$.executeInitFunctions=function(callback){head.ready(function(){setTimeout(function(){$.addInitFunctions($.getInitFunctions());ccInitFunctions=$.merge($.merge([],ccInitFunctions),ccPluginFunctions);ccInitFunctions=$.arrayUnique(ccInitFunctions);var fncCnt=ccInitFunctions.length;$.each(ccInitFunctions,function(index,fcn){functionName=eval(fcn.name);if($.isFunction(functionName)){if(Array.isArray(fcn.params)){functionName.apply(this,fcn.params);}else{functionName(fcn.params);}}if(!--fncCnt){ccInitSuccess=true;ccInitCount++;if(callback&&$.isFunction(callback)){callback();}else{$.postPageLoadActions();}}});return true;},0.05);});};})(jQuery);(function($){$.arrayUnique=function(array){var result=[];$.each(array,function(i,e){var dupl=$.arrayAssocFind(result,e.name);if(!dupl)result.push(array[i]);});return result;};})(jQuery);(function($){$.arrayAssocFind=function(array,name){var found=false;$.each(array,function(i,e){if(typeof(e.name)!="undefined"&&e.name==name){found=true;}});return found;};})(jQuery);(function($){$.getWindowSize=function(){var windowWidth=0,windowHeight=0;if(typeof(window.innerWidth)=='number'){windowWidth=window.innerWidth;windowHeight=window.innerHeight;}else if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){windowWidth=document.documentElement.clientWidth;windowHeight=document.documentElement.clientHeight;}else if(document.body&&(document.body.clientWidth||document.body.clientHeight)){windowWidth=document.body.clientWidth;windowHeight=document.body.clientHeight;}return[windowWidth,windowHeight];};})(jQuery);(function($){$.fn.getElementWidth=function(){var conElem=$(this);if(typeof(conElem[0])!="undefined"&&typeof(conElem[0].getBoundingClientRect)=="function"){return conElem[0].getBoundingClientRect().width;}return conElem.width();},$.fn.getElementHeight=function(conElem){var conElem=$(this);if(typeof(conElem[0])!="undefined"&&typeof(conElem[0].getBoundingClientRect)=="function"){return conElem[0].getBoundingClientRect().height;}return conElem.height();};})(jQuery);(function($){$.fn.loading=function(callback){if($(this).is('img')){$(this).prop('src',ccWaitImg.src).waitForImages(function(){if($.isFunction(callback)){callback();}});}else{var elem=$(this).hasClass('cc-icons')?$(this):$(this).find('.cc-icons');elem.addClass('cc-icon-loading');if($.isFunction(callback)){callback();}}},$.fn.loadingRemove=function(src,callback){if($(this).is('img')){$(this).prop('src',src).waitForImages(function(){if($.isFunction(callback)){callback();}});}else{var elem=$(this).hasClass('cc-icons')?$(this):$(this).find('.cc-icons');elem.removeClass('cc-icon-loading');if($.isFunction(callback)){callback();}}},$.refreshPage=function(hash){var url=document.location.href.split('?')[0];if(!hash){url=url.split('#')[0];}document.location.href=url;};}(jQuery));(function($){$.mceAddEditors=function(textareas){if(typeof(textareas)!="object"||typeof(tinymce)!="object"){return false;}textareas.each(function(i,e){var taID=$(e).attr('id');if(typeof(edi)=="object"){tinymce.execCommand('mceRemoveEditor',true,taID);}tinymce.execCommand('mceRemoveEditor',true,taID);tinymce.execCommand('mceAddEditor',true,taID);});return true;};$.mceRemoveEditors=function(textareas){if(typeof(textareas)!="object"||typeof(tinymce)!="object"){return false;}textareas.each(function(i,e){var taID=$(e).attr('id');var edi=tinymce.editors[taID];if(typeof(edi)=="object"){tinymce.execCommand('mceRemoveEditor',true,taID);}});return true;};$.toggleEditor=function(ed,show){var edID=ed;if(typeof(ed)=="object"){edID=ed.id;}var trigger='.toggleEditor[data-target="'+edID+'"]';var textarea=$('textarea[id="'+edID+'"]').not('.cc-always-hide');$('body').off("click",trigger);$('body').on("click",trigger,function(){var edIn=tinymce.EditorManager.editors[edID];if(typeof(edIn)=="undefined"){return false;}if(show||edIn.isHidden()){edIn.show();textarea.hide();cc.openEditors++;}else{edIn.hide();textarea.show();cc.openEditors--;}});};$.destroyEditors=function(ed,show){if(typeof($.myTinyMCE)=="function"){$.myTinyMCE=null;}if(typeof($.myCodeMirror)=="function"){$.myCodeMirror=null;}};})(jQuery);/*! waitForImages jQuery Plugin - v1.5.0 - 2013-07-20
 https://github.com/alexanderdickson/waitForImages
 Copyright (c) 2013 Alex Dickson; Licensed MIT */(function($){var eventNamespace='waitForImages';$.waitForImages={hasImageProperties:['backgroundImage','listStyleImage','borderImage','borderCornerImage','cursor']};$.expr[':'].uncached=function(obj){if(!$(obj).is('img[src!=""]')){return false;}var img=new Image();img.src=obj.src;return!img.complete;};$.fn.waitForImages=function(finishedCallback,eachCallback,waitForAll){var allImgsLength=0;var allImgsLoaded=0;if($.isPlainObject(arguments[0])){waitForAll=arguments[0].waitForAll;eachCallback=arguments[0].each;finishedCallback=arguments[0].finished;}finishedCallback=finishedCallback||$.noop;eachCallback=eachCallback||$.noop;waitForAll=!!waitForAll;if(!$.isFunction(finishedCallback)||!$.isFunction(eachCallback)){throw new TypeError('An invalid callback was supplied.');}return this.each(function(){var obj=$(this);var allImgs=[];var hasImgProperties=$.waitForImages.hasImageProperties||[];var matchUrl=/url\(\s*(['"]?)(.*?)\1\s*\)/g;if(waitForAll){obj.find('*').addBack().each(function(){var element=$(this);if(element.is('img:uncached')){allImgs.push({src:element.attr('src'),element:element[0]});}$.each(hasImgProperties,function(i,property){var propertyValue=element.css(property);var match;if(!propertyValue){return true;}while(match=matchUrl.exec(propertyValue)){allImgs.push({src:match[2],element:element[0]});}});});}else{obj.find('img:uncached').each(function(){allImgs.push({src:this.src,element:this});});}allImgsLength=allImgs.length;allImgsLoaded=0;if(allImgsLength===0){finishedCallback.call(obj[0]);}$.each(allImgs,function(i,img){var image=new Image();$(image).on('load.'+eventNamespace+' error.'+eventNamespace,function(event){allImgsLoaded++;eachCallback.call(img.element,allImgsLoaded,allImgsLength,event.type=='load');if(allImgsLoaded==allImgsLength){finishedCallback.call(obj[0]);return false;}});image.src=img.src;});});};}(jQuery));(function($){$.cookie=function(key,value,options){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(value))||value===null||value===undefined)){options=$.extend({},options);if(value===null||value===undefined){options.expires=-1;}if(typeof options.expires==='number'){var days=options.expires,t=options.expires=new Date();t.setDate(t.getDate()+days);}value=String(value);return(document.cookie=[encodeURIComponent(key),'=',options.raw?value:encodeURIComponent(value),options.expires?'; expires='+options.expires.toUTCString():'',options.path?'; path='+options.path:'',options.domain?'; domain='+options.domain:'',options.secure?'; secure':''].join(''));}options=value||{};var decode=options.raw?function(s){return s;}:decodeURIComponent;var pairs=document.cookie.split('; ');for(var i=0,pair;pair=pairs[i]&&pairs[i].split('=');i++){if(decode(pair[0])===key)return decode(pair[1]||'');}return null;};})(jQuery);